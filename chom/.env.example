# ============================================================================
# CHOM - CPanel Hosting Operations Manager
# Development Environment Configuration
# ============================================================================

# ----------------------------------------------------------------------------
# APPLICATION SETTINGS
# ----------------------------------------------------------------------------
APP_NAME="CHOM"
APP_ENV=local                    # local, staging, production
APP_KEY=                         # Auto-generated by: php artisan key:generate
APP_DEBUG=true                   # CRITICAL: Set to false in production
APP_URL=http://localhost:8000    # Your application URL

# Localization
APP_LOCALE=en
APP_FALLBACK_LOCALE=en
APP_FAKER_LOCALE=en_US

# Maintenance Mode
APP_MAINTENANCE_DRIVER=file
# APP_MAINTENANCE_STORE=database

# PHP Configuration
# PHP_CLI_SERVER_WORKERS=4       # Uncomment to use multiple workers

# Password Hashing
BCRYPT_ROUNDS=12                 # Higher = more secure but slower (10-12 recommended)

# ----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# ----------------------------------------------------------------------------
LOG_CHANNEL=stack                # stack, single, daily, slack, syslog
LOG_STACK=single                 # Channels to include in stack
LOG_DEPRECATIONS_CHANNEL=null    # Set to a channel to log deprecations
LOG_LEVEL=debug                  # debug, info, notice, warning, error, critical, alert, emergency

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------
# SQLite (Default for local development)
DB_CONNECTION=sqlite

# MySQL/MariaDB (Uncomment to use with Docker)
# DB_CONNECTION=mysql
# DB_HOST=127.0.0.1              # Use 'mysql' if using Docker Compose
# DB_PORT=3306
# DB_DATABASE=chom
# DB_USERNAME=chom
# DB_PASSWORD=secret

# PostgreSQL (Alternative)
# DB_CONNECTION=pgsql
# DB_HOST=127.0.0.1
# DB_PORT=5432
# DB_DATABASE=chom
# DB_USERNAME=chom
# DB_PASSWORD=secret

# ----------------------------------------------------------------------------
# SESSION CONFIGURATION
# ----------------------------------------------------------------------------
SESSION_DRIVER=redis             # file, cookie, database, apc, memcached, redis, dynamodb
SESSION_LIFETIME=120             # Minutes until session expires
SESSION_ENCRYPT=false            # Encrypt session data
SESSION_PATH=/
SESSION_DOMAIN=null

# SECURITY: Session Security Configuration
# These settings harden session security against common attacks
SESSION_EXPIRE_ON_CLOSE=true    # Session expires when browser closes
SESSION_SECURE_COOKIE=true      # CRITICAL: Requires HTTPS (disable for local HTTP)
SESSION_SAME_SITE=strict        # strict, lax, or none

# ----------------------------------------------------------------------------
# CACHE CONFIGURATION
# ----------------------------------------------------------------------------
CACHE_STORE=redis                # apc, array, database, file, memcached, redis, dynamodb
CACHE_PREFIX=chom_cache          # Prefix for cache keys

# ----------------------------------------------------------------------------
# QUEUE CONFIGURATION
# ----------------------------------------------------------------------------
QUEUE_CONNECTION=redis           # sync, database, beanstalkd, sqs, redis
BROADCAST_CONNECTION=log         # pusher, ably, redis, log, null

# ----------------------------------------------------------------------------
# FILESYSTEM CONFIGURATION
# ----------------------------------------------------------------------------
FILESYSTEM_DISK=local            # local, public, s3, ftp, sftp

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION
# ----------------------------------------------------------------------------
# High Performance Cache & Queue Backend
# Run with Docker: docker-compose up -d redis
REDIS_CLIENT=phpredis            # phpredis (recommended) or predis
REDIS_HOST=127.0.0.1             # Use 'redis' if using Docker Compose
REDIS_PASSWORD=null
REDIS_PORT=6379

# Database Separation (0-15 available)
REDIS_DB=0                       # Default database
REDIS_CACHE_DB=1                 # Cache-specific database
REDIS_QUEUE_DB=2                 # Queue-specific database
REDIS_SESSION_DB=3               # Session-specific database

# Performance Tuning
REDIS_PREFIX=chom                # Key prefix for namespacing
REDIS_MAX_RETRIES=3              # Connection retry attempts
REDIS_PERSISTENT=false           # Persistent connections

# ----------------------------------------------------------------------------
# MAIL CONFIGURATION
# ============================================================================
# Email Service Configuration
# Supports: SendGrid, Mailgun, AWS SES, Postmark, SMTP, and local development
# ============================================================================

# Default Mailer (Options: sendgrid, mailgun, ses, postmark, smtp, sendmail, log, array)
# - Development: Use 'log' to see emails in storage/logs/laravel.log
# - Development: Use 'array' to prevent any email sending
# - Production: Use 'sendgrid', 'mailgun', or 'ses'
MAIL_MAILER=log

# Generic SMTP Configuration (used if MAIL_MAILER=smtp)
MAIL_SCHEME=tls                  # tls, ssl, or null
MAIL_HOST=127.0.0.1              # For Docker MailHog: mailhog (no auth needed)
MAIL_PORT=2525                   # SMTP port (MailHog=1025, Gmail=587, Office365=587)
MAIL_USERNAME=null               # SMTP username
MAIL_PASSWORD=null               # SMTP password
MAIL_ENCRYPTION=null             # tls, ssl, null

# Sender Information (Used by all mailers)
MAIL_FROM_ADDRESS="noreply@example.com"     # Must be a valid email domain
MAIL_FROM_NAME="${APP_NAME}"

# ============================================================================
# SENDGRID CONFIGURATION (Recommended - Free tier available)
# ============================================================================
# Free Tier: 100 emails/day (unlimited sending for first 3 months)
# Sign up: https://sendgrid.com/
# Docs: https://docs.sendgrid.com/for-developers/sending-email/quickstart-php
#
# Steps to Setup:
# 1. Create SendGrid account at https://sendgrid.com
# 2. Create API key in Settings > API Keys > Create API Key
# 3. Set below variable to 'sendgrid' to enable
# 4. Add your API key to .env or use environment variable
#
# To use SendGrid, set MAIL_MAILER=sendgrid and add API key:
# SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxx

# For production, uncomment and set these:
# MAIL_MAILER=sendgrid
# SENDGRID_API_KEY=${env('SENDGRID_API_KEY')}

# ============================================================================
# MAILGUN CONFIGURATION (Alternative - Free tier available)
# ============================================================================
# Free Tier: 5,000 emails/month (includes sandbox domain)
# Sign up: https://www.mailgun.com/
# Docs: https://documentation.mailgun.com/en/latest/quickstart.html
#
# Steps to Setup:
# 1. Create Mailgun account at https://www.mailgun.com
# 2. Get domain and API key from Mailgun Dashboard
# 3. Verify sender domain (required for production)
# 4. Set below variable to 'mailgun' to enable
#
# To use Mailgun, set MAIL_MAILER=mailgun and configure below:
# MAILGUN_DOMAIN=sandbox12345.mailgun.org
# MAILGUN_SECRET=key-xxxxxxxxxxxxxxxxxxxx
# MAILGUN_ENDPOINT=api.mailgun.net          # api.eu.mailgun.net for EU

# For production, uncomment and set these:
# MAIL_MAILER=mailgun
# MAILGUN_DOMAIN=${env('MAILGUN_DOMAIN')}
# MAILGUN_SECRET=${env('MAILGUN_SECRET')}
# MAILGUN_ENDPOINT=${env('MAILGUN_ENDPOINT', 'api.mailgun.net')}

# ============================================================================
# AWS SES CONFIGURATION (For AWS users)
# ============================================================================
# Free Tier: 62,000 emails/month (first 12 months)
# Docs: https://docs.aws.amazon.com/ses/
#
# Note: AWS credentials should be set in AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY
# Default region should be set in AWS_DEFAULT_REGION

# MAIL_MAILER=ses
# AWS_SES_REGION=${env('AWS_DEFAULT_REGION', 'us-east-1')}

# ============================================================================
# POSTMARK CONFIGURATION (Premium option)
# ============================================================================
# Free Trial: 100 emails for 30 days
# Docs: https://postmarkapp.com/
#
# To use Postmark:
# 1. Create account at https://postmarkapp.com
# 2. Get Server API token
# MAIL_MAILER=postmark
# POSTMARK_TOKEN=${env('POSTMARK_TOKEN')}

# ----------------------------------------------------------------------------
# AWS SERVICES (S3, SES, etc)
# ----------------------------------------------------------------------------
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_DEFAULT_REGION=us-east-1
AWS_BUCKET=
AWS_USE_PATH_STYLE_ENDPOINT=false

# For MinIO (S3-compatible local testing)
# AWS_ENDPOINT=http://localhost:9000
# AWS_USE_PATH_STYLE_ENDPOINT=true

# ----------------------------------------------------------------------------
# MEMCACHED
# ----------------------------------------------------------------------------
MEMCACHED_HOST=127.0.0.1
MEMCACHED_PORT=11211

# ----------------------------------------------------------------------------
# FRONTEND BUILD (Vite)
# ----------------------------------------------------------------------------
VITE_APP_NAME="${APP_NAME}"
VITE_APP_ENV="${APP_ENV}"

# ----------------------------------------------------------------------------
# SECURITY: CORS CONFIGURATION
# ----------------------------------------------------------------------------
# CRITICAL: Set allowed origins for production (comma-separated list)
# NEVER use * in production - specify exact frontend URLs
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8000
CORS_ALLOWED_ORIGIN_PATTERNS=

# ----------------------------------------------------------------------------
# SECURITY: SANCTUM TOKEN CONFIGURATION
# ----------------------------------------------------------------------------
# Laravel Sanctum for API authentication
# Tokens expire after 60 minutes with automatic rotation
SANCTUM_TOKEN_EXPIRATION=60           # Minutes
SANCTUM_TOKEN_ROTATION_ENABLED=true   # Rotate tokens before expiration
SANCTUM_TOKEN_ROTATION_THRESHOLD=15   # Minutes before expiration to rotate
SANCTUM_TOKEN_GRACE_PERIOD=5          # Minutes to accept old token after rotation
SANCTUM_STATEFUL_DOMAINS=localhost,localhost:3000,127.0.0.1,localhost:8000

# ----------------------------------------------------------------------------
# SECURITY: TWO-FACTOR AUTHENTICATION (2FA) CONFIGURATION
# ----------------------------------------------------------------------------
# TOTP-based two-factor authentication for enhanced security
# OWASP A07:2021 - Identification and Authentication Failures mitigation

# Enable/disable 2FA globally (set to false only in development)
AUTH_2FA_ENABLED=true

# Roles that require 2FA (comma-separated list)
# Default: owner,admin (privileged accounts)
# Options: owner, admin, member, viewer
AUTH_2FA_REQUIRED_ROLES=owner,admin

# Grace period (in days) for users to set up 2FA before enforcement
# After this period, access is blocked until 2FA is configured
AUTH_2FA_GRACE_PERIOD_DAYS=7

# Session timeout (in hours) for 2FA verification
# Users must re-verify 2FA after this duration
AUTH_2FA_SESSION_TIMEOUT_HOURS=24

# Number of backup recovery codes to generate during 2FA setup
AUTH_2FA_BACKUP_CODES_COUNT=8

# ----------------------------------------------------------------------------
# SECURITY: CONTENT SECURITY POLICY
# ----------------------------------------------------------------------------
# Optional: URL to report CSP violations in production
APP_CSP_REPORT_URI=

# ----------------------------------------------------------------------------
# STRIPE PAYMENT PROCESSING
# ----------------------------------------------------------------------------
# Test Mode Keys (prefix: pk_test_, sk_test_)
STRIPE_KEY=pk_test_xxxxx
STRIPE_SECRET=sk_test_xxxxx
STRIPE_WEBHOOK_SECRET=whsec_xxxxx

# Stripe Price IDs (create these in your Stripe Dashboard)
# https://dashboard.stripe.com/test/products
STRIPE_STARTER_PRICE_ID=price_xxxxx
STRIPE_PRO_PRICE_ID=price_xxxxx
STRIPE_ENTERPRISE_PRICE_ID=price_xxxxx

# Stripe Usage Metering Price IDs (optional, for overage billing)
STRIPE_EXTRA_SITE_PRICE_ID=price_xxxxx
STRIPE_EXTRA_STORAGE_PRICE_ID=price_xxxxx
STRIPE_EXTRA_BANDWIDTH_PRICE_ID=price_xxxxx

# Production Keys (uncomment and set in production)
# STRIPE_KEY=pk_live_xxxxx
# STRIPE_SECRET=sk_live_xxxxx

# ----------------------------------------------------------------------------
# CHOM PLATFORM CONFIGURATION
# ----------------------------------------------------------------------------
CHOM_NAME=CHOM

# SSH Key Path (for VPS provisioning)
CHOM_SSH_KEY_PATH="${APP_ROOT}/storage/app/ssh/chom_deploy_key"

# Default VPS Configuration
CHOM_DEFAULT_VPS_USER=chom
CHOM_DEFAULT_VPS_PORT=22

# Backup Configuration
CHOM_BACKUP_RETENTION_DAYS=30
CHOM_BACKUP_MAX_SIZE_GB=10

# Rate Limiting
CHOM_API_RATE_LIMIT=60          # Requests per minute
CHOM_API_RATE_LIMIT_BURST=100   # Burst allowance

# ----------------------------------------------------------------------------
# OBSERVABILITY STACK (mentat_tst Integration)
# ----------------------------------------------------------------------------
# Master switch for all observability features
OBSERVABILITY_ENABLED=false

# ----------------------------------------------------------------------------
# PROMETHEUS - Metrics Collection
# ----------------------------------------------------------------------------
# Prometheus server URL (on mentat_tst)
PROMETHEUS_URL=http://mentat-tst:9090
PROMETHEUS_ENABLED=false

# Metric namespace prefix (all metrics will be prefixed with this)
PROMETHEUS_NAMESPACE=chom

# Pushgateway for batch metric pushing (optional)
# PROMETHEUS_PUSHGATEWAY_URL=http://mentat-tst:9091

# Basic auth for /metrics endpoint (recommended for production)
PROMETHEUS_AUTH_ENABLED=false
# PROMETHEUS_AUTH_USERNAME=prometheus
# PROMETHEUS_AUTH_PASSWORD=secret

# Legacy aliases (deprecated, use above instead)
CHOM_PROMETHEUS_URL=http://localhost:9090

# ----------------------------------------------------------------------------
# LOKI - Log Aggregation
# ----------------------------------------------------------------------------
# Loki server URL (on mentat_tst)
LOKI_URL=http://mentat-tst:3100
LOKI_ENABLED=false

# Push logs directly to Loki (alternative to Promtail)
LOKI_PUSH_ENABLED=false

# Legacy aliases
CHOM_LOKI_URL=http://localhost:3100

# ----------------------------------------------------------------------------
# TEMPO - Distributed Tracing (OpenTelemetry)
# ----------------------------------------------------------------------------
# Enable distributed tracing
TEMPO_ENABLED=false

# Tempo OTLP endpoint (on mentat_tst)
TEMPO_ENDPOINT=http://mentat-tst:4318

# OpenTelemetry configuration
OTEL_SERVICE_NAME=chom
OTEL_EXPORTER_OTLP_ENDPOINT=http://mentat-tst:4318
OTEL_EXPORTER_OTLP_PROTOCOL=http/protobuf

# Trace sampling rate (0.0 to 1.0, 0.1 = 10% of requests)
OTEL_TRACES_SAMPLER_ARG=0.1

# ----------------------------------------------------------------------------
# GRAFANA - Visualization
# ----------------------------------------------------------------------------
# Grafana server URL (on mentat_tst)
GRAFANA_URL=http://mentat-tst:3000
GRAFANA_ENABLED=false

# API key for dashboard management (create in Grafana admin)
GRAFANA_API_KEY=

# Dashboard UIDs for embedding
GRAFANA_DASHBOARD_OVERVIEW=chom-overview
GRAFANA_DASHBOARD_SITES=chom-sites
GRAFANA_DASHBOARD_VPS=chom-vps

# Legacy aliases
CHOM_GRAFANA_URL=http://localhost:3000
CHOM_GRAFANA_API_KEY=

# ----------------------------------------------------------------------------
# ALERTMANAGER - Alert Routing
# ----------------------------------------------------------------------------
ALERTING_ENABLED=false
ALERTMANAGER_URL=http://mentat-tst:9093

# Alert notification channels (optional)
# ALERT_SLACK_WEBHOOK=https://hooks.slack.com/services/xxx
# ALERT_EMAIL_TO=ops@example.com

# ----------------------------------------------------------------------------
# LOGGING FOR OBSERVABILITY
# ----------------------------------------------------------------------------
# For production with Promtail, use: LOG_CHANNEL=observability
# LOG_CHANNEL=observability
# LOG_OBSERVABILITY_CHANNELS=json_file

# For container deployments (stdout):
# LOG_CHANNEL=production

# ----------------------------------------------------------------------------
# REQUEST TRACING
# ----------------------------------------------------------------------------
# Enable request-level tracing
REQUEST_TRACING_ENABLED=true

# Slow request threshold (milliseconds)
SLOW_REQUEST_THRESHOLD=1000

# ----------------------------------------------------------------------------
# METRICS STORAGE
# ----------------------------------------------------------------------------
# Driver for storing metrics locally (redis recommended)
METRICS_STORAGE_DRIVER=redis
METRICS_STORAGE_PREFIX=metrics:

# Sentry Error Tracking (optional, alternative to Loki for errors)
# SENTRY_LARAVEL_DSN=
# SENTRY_TRACES_SAMPLE_RATE=0.2

# ----------------------------------------------------------------------------
# DEVELOPMENT TOOLS
# ----------------------------------------------------------------------------
# Telescope (Laravel debugging assistant)
TELESCOPE_ENABLED=true           # Disable in production
TELESCOPE_DRIVER=database        # database, redis

# Debugbar (Laravel debugbar)
DEBUGBAR_ENABLED=true            # Auto-disabled in production

# Clockwork (alternative debugbar)
# CLOCKWORK_ENABLE=true

# ----------------------------------------------------------------------------
# TESTING CONFIGURATION
# ----------------------------------------------------------------------------
# These override main settings during testing
# Uncomment and modify as needed

# TEST_DB_CONNECTION=sqlite
# TEST_DB_DATABASE=:memory:
# TEST_CACHE_DRIVER=array
# TEST_SESSION_DRIVER=array
# TEST_QUEUE_CONNECTION=sync

# ----------------------------------------------------------------------------
# QUICK START COMMANDS
# ----------------------------------------------------------------------------
# Setup development environment:
#   ./scripts/setup-dev.sh
#
# Start all services:
#   composer run dev
#
# Start individual services:
#   php artisan serve          # Web server (http://localhost:8000)
#   npm run dev                # Frontend build with HMR
#   php artisan queue:listen   # Queue worker
#   php artisan pail           # Log viewer
#
# Docker services:
#   docker-compose up -d       # Start all Docker services
#   docker-compose down        # Stop all Docker services
#
# Access URLs:
#   App:            http://localhost:8000
#   MailHog UI:     http://localhost:8025
#   Adminer:        http://localhost:8080
#   Redis GUI:      http://localhost:8081
#   MinIO Console:  http://localhost:9001
#   Grafana:        http://localhost:3000
#   Prometheus:     http://localhost:9090
#
# Useful commands:
#   composer test              # Run test suite
#   php artisan migrate:fresh  # Reset database
#   php artisan db:seed        # Seed with test data
#   php artisan tinker         # Interactive console
#   php artisan route:list     # List all routes
#   php artisan queue:work     # Process queue jobs
